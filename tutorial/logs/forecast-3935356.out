
Lmod is automatically replacing "gcc-native/14.2" with "gcc/12.2.0".


The following have been reloaded with a version change:
  1) cray-libsci/24.11.0 => cray-libsci/23.09.1.1
  2) cray-mpich/8.1.31 => cray-mpich/8.1.27
  3) libfabric/1.22.0 => libfabric/1.20.1

Job configuration:
  ERA5_DIR      = /lustre/orion/lrn036/world-shared/ERA5_npz/1.40625_deg/
  FORECAST_TYPE = direct
  MODEL         = res_slimvit
  PRED_RANGE    = 120
  MAX_EPOCHS    = 5
  PATIENCE      = 5
  OUTPUT_DIR    = /lustre/orion/csc662/proj-shared/janet/forecasting
  CHECKPOINT    = /lustre/orion/csc662/proj-shared/janet/forecasting/v4_test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
Loading model: res_slimvit
Loading optimizer adamw
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading training loss: lat_mse
No train transform
Loading validation loss: lat_rmse
Loading validation loss: lat_acc
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation transform: denormalize
No validation transform
Loading test loss: lat_rmse
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test transform: denormalize
[rank: 0] Seed set to 0
/lustre/orion/csc662/proj-shared/janet/miniconda3/envs/orbit/lib/python3.13/site-packages/lightning_fabric/strategies/fsdp.py:697: `FSDPStrategy(activation_checkpointing=<class 'timm.models.vision_transformer.Block'>)` is deprecated, use `FSDPStrategy(activation_checkpointing_policy={<class 'timm.models.vision_transformer.Block'>})` instead.
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
You are using a CUDA device ('AMD Instinct MI250X') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[W1201 10:56:32.981627568 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier08861.frontier.olcf.ornl.gov]:20356 (errno: 97 - Address family not supported by protocol).
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/lustre/orion/csc662/proj-shared/janet/miniconda3/envs/orbit/lib/python3.13/site-packages/torch/distributed/fsdp/_init_utils.py:430: UserWarning: FSDP is switching to use `NO_SHARD` instead of ShardingStrategy.FULL_SHARD since the world size is 1.
  warnings.warn(
SLURM auto-requeueing enabled. Setting signal handlers.
/lustre/orion/csc662/proj-shared/janet/miniconda3/envs/orbit/lib/python3.13/site-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 7, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
[COLLATE DEBUG] Input shape after resize: torch.Size([128, 11, 32, 64]), Target shape: torch.Size([128, 1, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([128, 11, 32, 64]), Target shape: torch.Size([128, 1, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([128, 11, 32, 64]), Target shape: torch.Size([128, 1, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([128, 11, 32, 64]), Target shape: torch.Size([128, 1, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([128, 11, 32, 64]), Target shape: torch.Size([128, 1, 128, 256])
Testing: |          | 0/? [00:00<?, ?it/s]Testing: |          | 0/? [00:00<?, ?it/s]Testing DataLoader 0: |          | 0/? [00:00<?, ?it/s][COLLATE DEBUG] Input shape after resize: torch.Size([128, 11, 32, 64]), Target shape: torch.Size([128, 1, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([128, 11, 32, 64]), Target shape: torch.Size([128, 1, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([128, 11, 32, 64]), Target shape: torch.Size([128, 1, 128, 256])
Testing DataLoader 0: |          | 0/? [00:22<?, ?it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃         Test metric          ┃         DataLoader 0         ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ test/lat_acc:2m_temperature  │      0.8590045595278182      │
│    test/lat_acc:aggregate    │      0.8590045595278182      │
│ test/lat_rmse:2m_temperature │      2.6467315378272738      │
│   test/lat_rmse:aggregate    │      2.6467315378272738      │
└──────────────────────────────┴──────────────────────────────┘

real	1m2.007s
user	0m0.018s
sys	0m0.033s
