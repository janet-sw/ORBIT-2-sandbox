
Lmod is automatically replacing "gcc-native/14.2" with "gcc/12.2.0".


The following have been reloaded with a version change:
  1) cray-libsci/24.11.0 => cray-libsci/23.09.1.1
  2) cray-mpich/8.1.31 => cray-mpich/8.1.27
  3) libfabric/1.22.0 => libfabric/1.20.1

Job configuration:
  ERA5_DIR      = /lustre/orion/lrn036/world-shared/ERA5_npz/1.40625_deg/
  FORECAST_TYPE = direct
  MODEL         = res_slimvit
  PRED_RANGE    = 120
  MAX_EPOCHS    = 50
  PATIENCE      = 20
  OUTPUT_DIR    = /lustre/orion/csc662/proj-shared/janet/forecasting
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
world_size 8 num_nodes 1
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
No train transform
No train transform
No train transform
No train transform
No train transform
No train transform
No train transform
No train transform
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation transform: denormalize
No validation transform
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation loss: lat_mse
Loading validation loss: lat_mse
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation loss: lat_mse
No validation transform
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation transform: denormalize
No validation transform
Loading validation transform: denormalize
No validation transform
No validation transform
No validation transform
No validation transform
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation transform: denormalize
No validation transform
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test loss: lat_acc
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test transform: denormalize
Loading test transform: denormalize
Loading test transform: denormalize
Loading test transform: denormalize
Loading test transform: denormalize
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test loss: lat_acc
Loading test transform: denormalize
[rank: 1] Seed set to 0
Loading test transform: denormalize
Loading test transform: denormalize
[rank: 2] Seed set to 0
Loading test transform: denormalize
[rank: 3] Seed set to 0
[rank: 5] Seed set to 0
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test transform: denormalize
[rank: 4] Seed set to 0
Loading test transform: denormalize
[rank: 7] Seed set to 0
Loading test transform: denormalize
[rank: 0] Seed set to 0
[rank: 6] Seed set to 0
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/lightning_fabric/strategies/fsdp.py:697: `FSDPStrategy(activation_checkpointing=<class 'timm.models.vision_transformer.Block'>)` is deprecated, use `FSDPStrategy(activation_checkpointing_policy={<class 'timm.models.vision_transformer.Block'>})` instead.
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
>> Fresh run (DownsampleToLR incompatible with old checkpoints)
>> Fresh run (DownsampleToLR incompatible with old checkpoints)
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/8
Initializing distributed: GLOBAL_RANK: 7, MEMBER: 8/8
[W1112 16:37:19.558372946 socket.cpp:752] [c10d] The client socket cannot be initialized to connect to [frontier04352.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1112 16:37:19.558410859 socket.cpp:752] [c10d] The client socket cannot be initialized to connect to [frontier04352.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
GPU available: True (cuda), used: True
>> Fresh run (DownsampleToLR incompatible with old checkpoints)
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
>> Fresh run (DownsampleToLR incompatible with old checkpoints)
`Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
>> Fresh run (DownsampleToLR incompatible with old checkpoints)
>> Fresh run (DownsampleToLR incompatible with old checkpoints)
>> Fresh run (DownsampleToLR incompatible with old checkpoints)
>> Fresh run (DownsampleToLR incompatible with old checkpoints)
You are using a CUDA device ('AMD Instinct MI250X') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/8
[W1112 16:37:19.595557721 socket.cpp:752] [c10d] The client socket cannot be initialized to connect to [frontier04352.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
Initializing distributed: GLOBAL_RANK: 6, MEMBER: 7/8
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/8
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/8
Initializing distributed: GLOBAL_RANK: 4, MEMBER: 5/8
Initializing distributed: GLOBAL_RANK: 5, MEMBER: 6/8
[W1112 16:37:19.599629807 socket.cpp:752] [c10d] The client socket cannot be initialized to connect to [frontier04352.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1112 16:37:19.600225504 socket.cpp:752] [c10d] The client socket cannot be initialized to connect to [frontier04352.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1112 16:37:19.600250412 socket.cpp:752] [c10d] The client socket cannot be initialized to connect to [frontier04352.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1112 16:37:19.600310679 socket.cpp:752] [c10d] The client socket cannot be initialized to connect to [frontier04352.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1112 16:37:19.719059854 socket.cpp:752] [c10d] The client socket cannot be initialized to connect to [frontier04352.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 8 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 4 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 5 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 7 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 6 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/utilities/model_summary/model_summary.py:231: Precision bf16-mixed is not supported by the model summary.  Estimated model size in MB will not be accurate. Using 32 bits instead.
┏━━━┳━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃   ┃ Name ┃ Type           ┃ Params ┃ Mode  ┃
┡━━━╇━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ 0 │ net  │ DownsampleToLR │  249 K │ train │
└───┴──────┴────────────────┴────────┴───────┘
Trainable params: 249 K                                                         
Non-trainable params: 0                                                         
Total params: 249 K                                                             
Total estimated model params size (MB): 0                                       
Modules in train mode: 209                                                      
Modules in eval mode: 0                                                         
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
MIOpen(HIP): Error [FlushUnsafe] File is unwritable: "/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt"
MIOpen(HIP): Error [~FindDbRecord_t] Failed to store record to find-db at <"/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt">
MIOpen Error: /MIOpen/src/sqlite_db.cpp:226: Internal error while accessing SQLite database: disk I/O error
[rank5]: Traceback (most recent call last):
[rank5]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 396, in <module>
[rank5]:     trainer.fit(model, datamodule=dm, ckpt_path=None)
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
[rank5]:     call._call_and_handle_interrupt(
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
[rank5]:     return trainer_fn(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
[rank5]:     self._run(model, ckpt_path=ckpt_path)
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
[rank5]:     results = self._run_stage()
[rank5]:               ^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
[rank5]:     self._run_sanity_check()
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
[rank5]:     val_loop.run()
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
[rank5]:     return loop_run(self, *args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
[rank5]:     self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
[rank5]:     output = call._call_strategy_hook(trainer, hook_name, *step_args)
[rank5]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
[rank5]:     output = fn(*args, **kwargs)
[rank5]:              ^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
[rank5]:     return self._forward_redirection(self.model, self.lightning_module, "validation_step", *args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank5]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank5]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank5]:     return self._call_impl(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank5]:     return forward_call(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
[rank5]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank5]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank5]:     return self._call_impl(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank5]:     return forward_call(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank5]:     out = method(*_args, **_kwargs)
[rank5]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 105, in validation_step
[rank5]:     self.evaluate(batch, "val")
[rank5]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 121, in evaluate
[rank5]:     yhat = self(x).to(device=y.device)
[rank5]:            ^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank5]:     return self._call_impl(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank5]:     return forward_call(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 67, in forward
[rank5]:     return self.net(x)
[rank5]:            ^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank5]:     return self._call_impl(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank5]:     return forward_call(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 118, in forward
[rank5]:     return self.net(x, *args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank5]:     return self._call_impl(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank5]:     return forward_call(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/hub/res_slimvit.py", line 151, in forward
[rank5]:     path2_result = self.path2(x)
[rank5]:                    ^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank5]:     return self._call_impl(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank5]:     return forward_call(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank5]:     input = module(input)
[rank5]:             ^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank5]:     return self._call_impl(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank5]:     return forward_call(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank5]:     return self._conv_forward(input, self.weight, self.bias)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank5]:     return F.conv2d(
[rank5]:            ^^^^^^^^^
[rank5]: RuntimeError: miopenStatusInternalError
MIOpen(HIP): Error [FlushUnsafe] File is unwritable: "/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt"
MIOpen(HIP): Error [~FindDbRecord_t] Failed to store record to find-db at <"/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt">
MIOpen Error: /MIOpen/src/sqlite_db.cpp:226: Internal error while accessing SQLite database: disk I/O error
MIOpen(HIP): Error [FlushUnsafe] File is unwritable: "/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt"
MIOpen(HIP): Error [~FindDbRecord_t] Failed to store record to find-db at <"/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt">
MIOpen Error: /MIOpen/src/sqlite_db.cpp:226: Internal error while accessing SQLite database: disk I/O error

MIOpen(HIP): Error [FlushUnsafe] File is unwritable: "/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt"
MIOpen(HIP): Error [~FindDbRecord_t] Failed to store record to find-db at <"/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt">
MIOpen Error: /MIOpen/src/sqlite_db.cpp:226: Internal error while accessing SQLite database: disk I/O error
MIOpen(HIP): Error [FlushUnsafe] File is unwritable: "/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt"
MIOpen(HIP): Error [~FindDbRecord_t] Failed to store record to find-db at <"/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt">
MIOpen Error: /MIOpen/src/sqlite_db.cpp:226: Internal error while accessing SQLite database: disk I/O error
MIOpen(HIP): Error [FlushUnsafe] File is unwritable: "/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt"
MIOpen(HIP): Error [~FindDbRecord_t] Failed to store record to find-db at <"/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt">
MIOpen Error: /MIOpen/src/sqlite_db.cpp:226: Internal error while accessing SQLite database: disk I/O error
MIOpen(HIP): Error [FlushUnsafe] File is unwritable: "/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt"
MIOpen(HIP): Error [~FindDbRecord_t] Failed to store record to find-db at <"/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt">
MIOpen Error: /MIOpen/src/sqlite_db.cpp:226: Internal error while accessing SQLite database: disk I/O error
MIOpen(HIP): Error [FlushUnsafe] File is unwritable: "/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt"
MIOpen(HIP): Error [~FindDbRecord_t] Failed to store record to find-db at <"/lustre/orion/csc662/proj-shared/janet/miopen_cache/3889588/gfx90a6e.HIP.3_2_0_.ufdb.txt">
MIOpen Error: /MIOpen/src/sqlite_db.cpp:226: Internal error while accessing SQLite database: disk I/O error
[rank2]: Traceback (most recent call last):
[rank2]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 396, in <module>
[rank2]:     trainer.fit(model, datamodule=dm, ckpt_path=None)
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
[rank2]:     call._call_and_handle_interrupt(
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
[rank2]:     return trainer_fn(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
[rank2]:     self._run(model, ckpt_path=ckpt_path)
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
[rank2]:     results = self._run_stage()
[rank2]:               ^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
[rank2]:     self._run_sanity_check()
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
[rank2]:     val_loop.run()
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
[rank2]:     return loop_run(self, *args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
[rank2]:     self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
[rank2]:     output = call._call_strategy_hook(trainer, hook_name, *step_args)
[rank2]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
[rank2]:     output = fn(*args, **kwargs)
[rank2]:              ^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
[rank2]:     return self._forward_redirection(self.model, self.lightning_module, "validation_step", *args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank2]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank2]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
[rank2]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank2]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank2]:     out = method(*_args, **_kwargs)
[rank2]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 105, in validation_step
[rank2]:     self.evaluate(batch, "val")
[rank2]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 121, in evaluate
[rank2]:     yhat = self(x).to(device=y.device)
[rank2]:            ^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 67, in forward
[rank2]:     return self.net(x)
[rank2]:            ^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 118, in forward
[rank2]:     return self.net(x, *args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/hub/res_slimvit.py", line 151, in forward
[rank2]:     path2_result = self.path2(x)
[rank2]:                    ^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank2]:     input = module(input)
[rank2]:             ^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank2]:     return self._conv_forward(input, self.weight, self.bias)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank2]:     return F.conv2d(
[rank2]:            ^^^^^^^^^
[rank2]: RuntimeError: miopenStatusInternalError
[rank0]: Traceback (most recent call last):
[rank0]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 396, in <module>
[rank0]:     trainer.fit(model, datamodule=dm, ckpt_path=None)
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
[rank0]:     call._call_and_handle_interrupt(
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
[rank0]:     return trainer_fn(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
[rank0]:     self._run(model, ckpt_path=ckpt_path)
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
[rank0]:     results = self._run_stage()
[rank0]:               ^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
[rank0]:     self._run_sanity_check()
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
[rank0]:     val_loop.run()
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
[rank0]:     return loop_run(self, *args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
[rank0]:     self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
[rank0]:     output = call._call_strategy_hook(trainer, hook_name, *step_args)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
[rank0]:     output = fn(*args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
[rank0]:     return self._forward_redirection(self.model, self.lightning_module, "validation_step", *args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank0]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank0]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
[rank0]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank0]:     out = method(*_args, **_kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 105, in validation_step
[rank0]:     self.evaluate(batch, "val")
[rank0]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 121, in evaluate
[rank0]:     yhat = self(x).to(device=y.device)
[rank0]:            ^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 67, in forward
[rank0]:     return self.net(x)
[rank0]:            ^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 118, in forward
[rank0]:     return self.net(x, *args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/hub/res_slimvit.py", line 151, in forward
[rank0]:     path2_result = self.path2(x)
[rank0]:                    ^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:             ^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank0]:     return self._conv_forward(input, self.weight, self.bias)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank0]:     return F.conv2d(
[rank0]:            ^^^^^^^^^
[rank0]: RuntimeError: miopenStatusInternalError
srun: error: frontier04352: task 5: Exited with exit code 1
srun: Terminating StepId=3889588.0
slurmstepd: error: *** STEP 3889588.0 ON frontier04352 CANCELLED AT 2025-11-12T16:37:59 ***
[rank: 4] Received SIGTERM: 15
[rank: 1] Received SIGTERM: 15
[rank: 3] Received SIGTERM: 15
[rank: 7] Received SIGTERM: 15
[rank: 6] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
[rank4]: Traceback (most recent call last):
[rank4]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 396, in <module>
[rank4]:     trainer.fit(model, datamodule=dm, ckpt_path=None)
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
[rank4]:     call._call_and_handle_interrupt(
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
[rank4]:     return trainer_fn(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
[rank4]:     self._run(model, ckpt_path=ckpt_path)
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
[rank4]:     results = self._run_stage()
[rank4]:               ^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
[rank4]:     self._run_sanity_check()
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
[rank4]:     val_loop.run()
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
[rank4]:     return loop_run(self, *args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
[rank4]:     self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
[rank4]:     output = call._call_strategy_hook(trainer, hook_name, *step_args)
[rank4]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
[rank4]:     output = fn(*args, **kwargs)
[rank4]:              ^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
[rank4]:     return self._forward_redirection(self.model, self.lightning_module, "validation_step", *args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank4]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank4]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank4]:     return self._call_impl(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank4]:     return forward_call(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
[rank4]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank4]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank4]:     return self._call_impl(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank4]:     return forward_call(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank4]:     out = method(*_args, **_kwargs)
[rank4]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 105, in validation_step
[rank4]:     self.evaluate(batch, "val")
[rank4]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 121, in evaluate
[rank4]:     yhat = self(x).to(device=y.device)
[rank4]:            ^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank4]:     return self._call_impl(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank4]:     return forward_call(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 67, in forward
[rank4]:     return self.net(x)
[rank4]:            ^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank4]:     return self._call_impl(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank4]:     return forward_call(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 118, in forward
[rank4]:     return self.net(x, *args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank4]:     return self._call_impl(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank4]:     return forward_call(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/hub/res_slimvit.py", line 151, in forward
[rank4]:     path2_result = self.path2(x)
[rank4]:                    ^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank4]:     return self._call_impl(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank4]:     return forward_call(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank4]:     input = module(input)
[rank4]:             ^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank4]:     return self._call_impl(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank4]:     return forward_call(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank4]:     return self._conv_forward(input, self.weight, self.bias)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank4]:     return F.conv2d(
[rank4]:            ^^^^^^^^^
[rank4]: RuntimeError: miopenStatusInternalError
[rank1]: Traceback (most recent call last):
[rank1]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 396, in <module>
[rank1]:     trainer.fit(model, datamodule=dm, ckpt_path=None)
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
[rank1]:     call._call_and_handle_interrupt(
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
[rank1]:     return trainer_fn(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
[rank1]:     self._run(model, ckpt_path=ckpt_path)
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
[rank1]:     results = self._run_stage()
[rank1]:               ^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
[rank1]:     self._run_sanity_check()
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
[rank1]:     val_loop.run()
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
[rank1]:     return loop_run(self, *args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
[rank1]:     self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
[rank1]:     output = call._call_strategy_hook(trainer, hook_name, *step_args)
[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
[rank1]:     output = fn(*args, **kwargs)
[rank1]:              ^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
[rank1]:     return self._forward_redirection(self.model, self.lightning_module, "validation_step", *args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank1]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank1]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
[rank1]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank1]:     out = method(*_args, **_kwargs)
[rank1]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 105, in validation_step
[rank1]:     self.evaluate(batch, "val")
[rank1]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 121, in evaluate
[rank1]:     yhat = self(x).to(device=y.device)
[rank1]:            ^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 67, in forward
[rank1]:     return self.net(x)
[rank1]:            ^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 118, in forward
[rank1]:     return self.net(x, *args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/hub/res_slimvit.py", line 151, in forward
[rank1]:     path2_result = self.path2(x)
[rank1]:                    ^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank1]:     input = module(input)
[rank1]:             ^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank1]:     return self._conv_forward(input, self.weight, self.bias)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank1]:     return F.conv2d(
[rank1]:            ^^^^^^^^^
[rank1]: RuntimeError: miopenStatusInternalError
[rank3]: Traceback (most recent call last):
[rank3]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 396, in <module>
[rank3]:     trainer.fit(model, datamodule=dm, ckpt_path=None)
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
[rank3]:     call._call_and_handle_interrupt(
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
[rank3]:     return trainer_fn(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
[rank3]:     self._run(model, ckpt_path=ckpt_path)
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
[rank3]:     results = self._run_stage()
[rank3]:               ^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
[rank3]:     self._run_sanity_check()
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
[rank3]:     val_loop.run()
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
[rank3]:     return loop_run(self, *args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
[rank3]:     self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
[rank3]:     output = call._call_strategy_hook(trainer, hook_name, *step_args)
[rank3]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
[rank3]:     output = fn(*args, **kwargs)
[rank3]:              ^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
[rank3]:     return self._forward_redirection(self.model, self.lightning_module, "validation_step", *args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank3]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank3]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
[rank3]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank3]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank3]:     out = method(*_args, **_kwargs)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 105, in validation_step
[rank3]:     self.evaluate(batch, "val")
[rank3]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 121, in evaluate
[rank3]:     yhat = self(x).to(device=y.device)
[rank3]:            ^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 67, in forward
[rank3]:     return self.net(x)
[rank3]:            ^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 118, in forward
[rank3]:     return self.net(x, *args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/hub/res_slimvit.py", line 151, in forward
[rank3]:     path2_result = self.path2(x)
[rank3]:                    ^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank3]:     input = module(input)
[rank3]:             ^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank3]:     return self._conv_forward(input, self.weight, self.bias)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank3]:     return F.conv2d(
[rank3]:            ^^^^^^^^^
[rank3]: RuntimeError: miopenStatusInternalError
[rank7]: Traceback (most recent call last):
[rank7]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 396, in <module>
[rank7]:     trainer.fit(model, datamodule=dm, ckpt_path=None)
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
[rank7]:     call._call_and_handle_interrupt(
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
[rank7]:     return trainer_fn(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
[rank7]:     self._run(model, ckpt_path=ckpt_path)
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
[rank7]:     results = self._run_stage()
[rank7]:               ^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
[rank7]:     self._run_sanity_check()
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
[rank7]:     val_loop.run()
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
[rank7]:     return loop_run(self, *args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
[rank7]:     self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
[rank7]:     output = call._call_strategy_hook(trainer, hook_name, *step_args)
[rank7]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
[rank7]:     output = fn(*args, **kwargs)
[rank7]:              ^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
[rank7]:     return self._forward_redirection(self.model, self.lightning_module, "validation_step", *args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank7]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank7]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank7]:     return self._call_impl(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank7]:     return forward_call(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
[rank7]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank7]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank7]:     return self._call_impl(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank7]:     return forward_call(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank7]:     out = method(*_args, **_kwargs)
[rank7]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 105, in validation_step
[rank7]:     self.evaluate(batch, "val")
[rank7]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 121, in evaluate
[rank7]:     yhat = self(x).to(device=y.device)
[rank7]:            ^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank7]:     return self._call_impl(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank7]:     return forward_call(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 67, in forward
[rank7]:     return self.net(x)
[rank7]:            ^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank7]:     return self._call_impl(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank7]:     return forward_call(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 118, in forward
[rank7]:     return self.net(x, *args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank7]:     return self._call_impl(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank7]:     return forward_call(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/hub/res_slimvit.py", line 151, in forward
[rank7]:     path2_result = self.path2(x)
[rank7]:                    ^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank7]:     return self._call_impl(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank7]:     return forward_call(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank7]:     input = module(input)
[rank7]:             ^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank7]:     return self._call_impl(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank7]:     return forward_call(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank7]:     return self._conv_forward(input, self.weight, self.bias)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank7]:     return F.conv2d(
[rank7]:            ^^^^^^^^^
[rank7]: RuntimeError: miopenStatusInternalError
srun: error: frontier04352: tasks 0,2: Terminated
[rank6]: Traceback (most recent call last):
[rank6]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 396, in <module>
[rank6]:     trainer.fit(model, datamodule=dm, ckpt_path=None)
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
[rank6]:     call._call_and_handle_interrupt(
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
[rank6]:     return trainer_fn(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
[rank6]:     self._run(model, ckpt_path=ckpt_path)
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
[rank6]:     results = self._run_stage()
[rank6]:               ^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
[rank6]:     self._run_sanity_check()
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
[rank6]:     val_loop.run()
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
[rank6]:     return loop_run(self, *args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
[rank6]:     self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
[rank6]:     output = call._call_strategy_hook(trainer, hook_name, *step_args)
[rank6]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
[rank6]:     output = fn(*args, **kwargs)
[rank6]:              ^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
[rank6]:     return self._forward_redirection(self.model, self.lightning_module, "validation_step", *args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank6]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank6]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank6]:     return self._call_impl(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank6]:     return forward_call(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
[rank6]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank6]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank6]:     return self._call_impl(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank6]:     return forward_call(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank6]:     out = method(*_args, **_kwargs)
[rank6]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 105, in validation_step
[rank6]:     self.evaluate(batch, "val")
[rank6]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 121, in evaluate
[rank6]:     yhat = self(x).to(device=y.device)
[rank6]:            ^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank6]:     return self._call_impl(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank6]:     return forward_call(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/module.py", line 67, in forward
[rank6]:     return self.net(x)
[rank6]:            ^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank6]:     return self._call_impl(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank6]:     return forward_call(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/tutorial/./era5_era5_forecasting_sup_res.py", line 118, in forward
[rank6]:     return self.net(x, *args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank6]:     return self._call_impl(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank6]:     return forward_call(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/autofs/nccs-svm1_home2/janetw/diffusion/ORBIT-2-sandbox/src/climate_learn/models/hub/res_slimvit.py", line 151, in forward
[rank6]:     path2_result = self.path2(x)
[rank6]:                    ^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank6]:     return self._call_impl(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank6]:     return forward_call(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank6]:     input = module(input)
[rank6]:             ^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank6]:     return self._call_impl(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank6]:     return forward_call(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank6]:     return self._conv_forward(input, self.weight, self.bias)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/ccs/home/janetw/miniconda3/envs/orbit/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank6]:     return F.conv2d(
[rank6]:            ^^^^^^^^^
[rank6]: RuntimeError: miopenStatusInternalError
srun: error: frontier04352: tasks 1,3-4: Exited with exit code 1
srun: error: frontier04352: tasks 6-7: Exited with exit code 1
srun: Force Terminated StepId=3889588.0

real	1m23.642s
user	0m0.017s
sys	0m0.046s
