
Lmod is automatically replacing "gcc-native/14.2" with "gcc/12.2.0".


The following have been reloaded with a version change:
  1) cray-libsci/24.11.0 => cray-libsci/23.09.1.1
  2) cray-mpich/8.1.31 => cray-mpich/8.1.27
  3) libfabric/1.22.0 => libfabric/1.20.1

Job configuration:
  ERA5_DIR      = /lustre/orion/lrn036/world-shared/ERA5_npz/1.40625_deg/
  FORECAST_TYPE = direct
  MODEL         = res_slimvit
  PRED_RANGE    = 120
  MAX_EPOCHS    = 50
  PATIENCE      = 20
  OUTPUT_DIR    = /lustre/orion/csc662/proj-shared/janet/forecasting
  CHECKPOINT    = 
world_size 8 num_nodes 1
[INFO] Using superres_factor=4 for LR 32x64 -> HR 128x256
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading model: res_slimvit
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading optimizer adamw
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading learning rate scheduler: linear-warmup-cosine-annealing
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
Loading training loss: lat_mse
No train transform
No train transform
No train transform
No train transform
No train transform
No train transform
No train transform
No train transform
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_rmse
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_acc
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation loss: lat_mse
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation loss: lat_mse
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation transform: denormalize
No validation transform
Loading validation transform: denormalize
Loading validation transform: denormalize
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation transform: denormalize
No validation transform
No validation transform
Loading validation transform: denormalize
Loading validation transform: denormalize
No validation transform
No validation transform
No validation transform
Loading validation loss: lat_mse
Loading validation transform: denormalize
Loading validation transform: denormalize
No validation transform
Loading validation transform: denormalize
No validation transform
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_rmse
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test transform: denormalize
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test transform: denormalize
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test transform: denormalize
Loading test loss: lat_acc
Loading test transform: denormalize
Loading test transform: denormalize
Loading test transform: denormalize
[rank: 0] Seed set to 0
[rank: 3] Seed set to 0
[rank: 4] Seed set to 0
[rank: 7] Seed set to 0
[rank: 1] Seed set to 0
[rank: 2] Seed set to 0
[rank: 5] Seed set to 0
[rank: 6] Seed set to 0
/lustre/orion/csc662/proj-shared/janet/miniconda3/envs/orbit/lib/python3.13/site-packages/lightning_fabric/strategies/fsdp.py:697: `FSDPStrategy(activation_checkpointing=<class 'timm.models.vision_transformer.Block'>)` is deprecated, use `FSDPStrategy(activation_checkpointing_policy={<class 'timm.models.vision_transformer.Block'>})` instead.
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
>> Resuming from: /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
>> Resuming from: /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
>> Resuming from: /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
>> Resuming from: /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
TPU available: False, using: 0 TPU cores
>> Resuming from: /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
>> Resuming from: /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
>> Resuming from: /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
>> Resuming from: /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
You are using a CUDA device ('AMD Instinct MI250X') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/8
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/8
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/8
Initializing distributed: GLOBAL_RANK: 5, MEMBER: 6/8
Initializing distributed: GLOBAL_RANK: 6, MEMBER: 7/8
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/8
Initializing distributed: GLOBAL_RANK: 4, MEMBER: 5/8
Initializing distributed: GLOBAL_RANK: 7, MEMBER: 8/8
[W1117 00:07:04.051345392 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier09077.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1117 00:07:04.051330604 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier09077.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1117 00:07:04.051334211 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier09077.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1117 00:07:04.053029575 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier09077.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1117 00:07:04.053094870 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier09077.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1117 00:07:04.053146247 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier09077.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1117 00:07:04.054712877 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier09077.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W1117 00:07:04.119260585 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [frontier09077.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 8 processes
----------------------------------------------------------------------------------------------------

/lustre/orion/csc662/proj-shared/janet/miniconda3/envs/orbit/lib/python3.13/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:751: Checkpoint directory /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 4 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 5 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 7 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 6 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
/lustre/orion/csc662/proj-shared/janet/miniconda3/envs/orbit/lib/python3.13/site-packages/pytorch_lightning/utilities/model_summary/model_summary.py:231: Precision bf16-mixed is not supported by the model summary.  Estimated model size in MB will not be accurate. Using 32 bits instead.
┏━━━┳━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃   ┃ Name ┃ Type         ┃ Params ┃ Mode  ┃
┡━━━╇━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ 0 │ net  │ Res_Slim_ViT │  256 K │ train │
└───┴──────┴──────────────┴────────┴───────┘
Trainable params: 256 K                                                         
Non-trainable params: 0                                                         
Total params: 256 K                                                             
Total estimated model params size (MB): 1                                       
Modules in train mode: 208                                                      
Modules in eval mode: 0                                                         
Restoring states from the checkpoint path at /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
Restored all states from the checkpoint at /lustre/orion/csc662/proj-shared/janet/forecasting/test_trans_resolution_res_slimvit_direct_forecasting_120/checkpoints/last.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
[COLLATE DEBUG] Input shape after resize: torch.Size([64, 26, 32, 64]), Target shape: torch.Size([64, 4, 128, 256])
Training: |          | 0/? [00:00<?, ?it/s]Training: |          | 0/? [00:00<?, ?it/s]Epoch 4: |          | 0/? [00:00<?, ?it/s] [COLLATE DEBUG] Input shape after resize: torch.Size([64, 26, 32, 64]), Target shape: torch.Size([64, 4, 128, 256])
======================================================================
ACTUAL TENSOR SHAPES IN TRAINING
======================================================================
Input (x) shape: torch.Size([64, 26, 32, 64])
Target (y) shape: torch.Size([64, 4, 128, 256])
Expected input: [batch, 26, 32, 64]
Expected target: [batch, 5, 128, 256]
======================================================================
Epoch 4: |          | 20/? [01:38<00:00,  0.20it/s]Epoch 4: |          | 20/? [01:38<00:00,  0.20it/s, v_num=12, train/lat_mse:aggregate=0.596]Epoch 4: |          | 40/? [01:40<00:00,  0.40it/s, v_num=12, train/lat_mse:aggregate=0.596]Epoch 4: |          | 40/? [01:40<00:00,  0.40it/s, v_num=12, train/lat_mse:aggregate=0.606]Epoch 4: |          | 60/? [01:42<00:00,  0.58it/s, v_num=12, train/lat_mse:aggregate=0.606]Epoch 4: |          | 60/? [01:42<00:00,  0.58it/s, v_num=12, train/lat_mse:aggregate=0.609]Epoch 4: |          | 80/? [01:44<00:00,  0.76it/s, v_num=12, train/lat_mse:aggregate=0.609]Epoch 4: |          | 80/? [01:44<00:00,  0.76it/s, v_num=12, train/lat_mse:aggregate=0.595]Epoch 4: |          | 100/? [01:47<00:00,  0.93it/s, v_num=12, train/lat_mse:aggregate=0.595]Epoch 4: |          | 100/? [01:47<00:00,  0.93it/s, v_num=12, train/lat_mse:aggregate=0.593]Epoch 4: |          | 100/? [01:57<00:00,  0.85it/s, v_num=12, train/lat_mse:aggregate=0.596]Epoch 4: |          | 0/? [00:00<?, ?it/s, v_num=12, train/lat_mse:aggregate=0.596]          Epoch 5: |          | 0/? [00:00<?, ?it/s, v_num=12, train/lat_mse:aggregate=0.596][COLLATE DEBUG] Input shape after resize: torch.Size([64, 26, 32, 64]), Target shape: torch.Size([64, 4, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([64, 26, 32, 64]), Target shape: torch.Size([64, 4, 128, 256])
Epoch 5: |          | 20/? [08:33<00:00,  0.04it/s, v_num=12, train/lat_mse:aggregate=0.596]Epoch 5: |          | 20/? [08:33<00:00,  0.04it/s, v_num=12, train/lat_mse:aggregate=0.611]Epoch 5: |          | 40/? [08:35<00:00,  0.08it/s, v_num=12, train/lat_mse:aggregate=0.611]Epoch 5: |          | 40/? [08:35<00:00,  0.08it/s, v_num=12, train/lat_mse:aggregate=0.609]Epoch 5: |          | 60/? [08:37<00:00,  0.12it/s, v_num=12, train/lat_mse:aggregate=0.609]Epoch 5: |          | 60/? [08:37<00:00,  0.12it/s, v_num=12, train/lat_mse:aggregate=0.585]Epoch 5: |          | 80/? [08:39<00:00,  0.15it/s, v_num=12, train/lat_mse:aggregate=0.585]Epoch 5: |          | 80/? [08:39<00:00,  0.15it/s, v_num=12, train/lat_mse:aggregate=0.615]Epoch 5: |          | 100/? [08:41<00:00,  0.19it/s, v_num=12, train/lat_mse:aggregate=0.615]Epoch 5: |          | 100/? [08:41<00:00,  0.19it/s, v_num=12, train/lat_mse:aggregate=0.599]Epoch 5: |          | 100/? [08:42<00:00,  0.19it/s, v_num=12, train/lat_mse:aggregate=0.604]Epoch 5: |          | 0/? [00:00<?, ?it/s, v_num=12, train/lat_mse:aggregate=0.604]          Epoch 6: |          | 0/? [00:00<?, ?it/s, v_num=12, train/lat_mse:aggregate=0.604][COLLATE DEBUG] Input shape after resize: torch.Size([64, 26, 32, 64]), Target shape: torch.Size([64, 4, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([64, 26, 32, 64]), Target shape: torch.Size([64, 4, 128, 256])
Epoch 6: |          | 20/? [09:11<00:00,  0.04it/s, v_num=12, train/lat_mse:aggregate=0.604]Epoch 6: |          | 20/? [09:11<00:00,  0.04it/s, v_num=12, train/lat_mse:aggregate=0.605]Epoch 6: |          | 40/? [09:13<00:00,  0.07it/s, v_num=12, train/lat_mse:aggregate=0.605]Epoch 6: |          | 40/? [09:13<00:00,  0.07it/s, v_num=12, train/lat_mse:aggregate=0.610]Epoch 6: |          | 60/? [09:15<00:00,  0.11it/s, v_num=12, train/lat_mse:aggregate=0.610]Epoch 6: |          | 60/? [09:15<00:00,  0.11it/s, v_num=12, train/lat_mse:aggregate=0.603]Epoch 6: |          | 80/? [09:17<00:00,  0.14it/s, v_num=12, train/lat_mse:aggregate=0.603]Epoch 6: |          | 80/? [09:17<00:00,  0.14it/s, v_num=12, train/lat_mse:aggregate=0.603]Epoch 6: |          | 100/? [09:19<00:00,  0.18it/s, v_num=12, train/lat_mse:aggregate=0.603]Epoch 6: |          | 100/? [09:19<00:00,  0.18it/s, v_num=12, train/lat_mse:aggregate=0.584]Epoch 6: |          | 100/? [09:20<00:00,  0.18it/s, v_num=12, train/lat_mse:aggregate=0.608]Epoch 6: |          | 0/? [00:00<?, ?it/s, v_num=12, train/lat_mse:aggregate=0.608]          Epoch 7: |          | 0/? [00:00<?, ?it/s, v_num=12, train/lat_mse:aggregate=0.608][COLLATE DEBUG] Input shape after resize: torch.Size([64, 26, 32, 64]), Target shape: torch.Size([64, 4, 128, 256])
[COLLATE DEBUG] Input shape after resize: torch.Size([64, 26, 32, 64]), Target shape: torch.Size([64, 4, 128, 256])
Epoch 7: |          | 20/? [08:39<00:00,  0.04it/s, v_num=12, train/lat_mse:aggregate=0.608]Epoch 7: |          | 20/? [08:39<00:00,  0.04it/s, v_num=12, train/lat_mse:aggregate=0.605]Epoch 7: |          | 40/? [08:41<00:00,  0.08it/s, v_num=12, train/lat_mse:aggregate=0.605]Epoch 7: |          | 40/? [08:41<00:00,  0.08it/s, v_num=12, train/lat_mse:aggregate=0.591]Epoch 7: |          | 60/? [08:42<00:00,  0.11it/s, v_num=12, train/lat_mse:aggregate=0.591]Epoch 7: |          | 60/? [08:42<00:00,  0.11it/s, v_num=12, train/lat_mse:aggregate=0.615]Epoch 7: |          | 80/? [08:44<00:00,  0.15it/s, v_num=12, train/lat_mse:aggregate=0.615]Epoch 7: |          | 80/? [08:44<00:00,  0.15it/s, v_num=12, train/lat_mse:aggregate=0.596]Epoch 7: |          | 100/? [08:46<00:00,  0.19it/s, v_num=12, train/lat_mse:aggregate=0.596]Epoch 7: |          | 100/? [08:46<00:00,  0.19it/s, v_num=12, train/lat_mse:aggregate=0.590]Epoch 7: |          | 100/? [08:48<00:00,  0.19it/s, v_num=12, train/lat_mse:aggregate=0.58srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 3897932.0 ON frontier09077 CANCELLED AT 2025-11-17T00:46:47 DUE TO TIME LIMIT ***
slurmstepd: error: *** JOB 3897932 ON frontier09077 CANCELLED AT 2025-11-17T00:46:47 DUE TO TIME LIMIT ***
